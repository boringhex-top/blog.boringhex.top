---
title: 开源基于ch9374b的键盘鼠标kvm设计
date: 2023-06-25 12:01:21
categories:
tags:
    - 嵌入式
    - 硬件
    - 工具
---

## 简介

平时经常有一种需求，就是我在调试树莓派的时候，经常要在pc电脑和开发板之间来回操作，因此就需要两套键盘和鼠标，但是我的桌子实在是太小了，两套键鼠不能并排放置，因此需要换来换取，再加上两套键盘手感不同。换起来着实烦气，因此就设计了这个键鼠切换工具。

实现键鼠pc之间的切换有好多种方法。包括软件来实现和硬件来实现，对于硬件来实现也有很多种方法，包括通过使用模拟开关来实现，和采用专业芯片来实现，对于使用模拟开关来实现，除了切换那一对差分信号线外，对上下电顺序也是有要求的，因此总会存在延时，而对于使用专门的芯片，延时将不复存在，就是成本略贵。

本设计基于CH9374B设计的KVM，CH9374B是一款4口USB KVM控制芯片，1套键鼠支持4套主机共享使用，即插即用，无需安装驱动程序。

## 功能特性

- 工作电压：5V或3.3V。 
- 晶振频率：24MHz，支持内置晶振，最高主频48MHz。 
- 支持1.5Mbps低速和12Mbps全速USB传输，兼容USB V2.0。 
- 外围电路简单、元器件只需电源退耦电容。 
- 支持Win98/ME/2K/XP/2003/Vista/Win7/Linux/AppleMAC等操作系统。 
- 支持市面上常见品牌的USB键盘和USB鼠标。 
- 支持PS2键盘，预留蓝牙键盘、蓝牙鼠标通信接口。 
- 支持单键轮循切换、多键指定切换、键盘热键切换和鼠标热键切换。 
- 支持红外遥控切换。 
- 支持自动轮询切换模式，便于监控，切换时间间隔可热键设置。 
- 支持开启/关闭自动侦测模式，用于检测插拔自动智能切换。 
- 支持开启/关闭蜂鸣器提示音。 
- 支持开启/关闭全部热键。 
- 支持开启/关闭鼠标穿屏功能。 
- 支持LED指示，指示当前选中的PC。 
- 支持4组不同的键盘切换热键，且可任意切换及掉电保存。 
- 支持DC-DC升压功能。 
- 支持在线升级固件。 
- 提供LQFP-64无铅封装，兼容RoHS。

<!-- more -->

## 设计图

只是简单的设计了一下，供自己使用：

![PCB 3D图](https://imgs.boringhex.top/blog/202306210018306.png)

![PCB实物图](https://imgs.boringhex.top/blog/202306210018647.jpg)

## 实现功能

* 基于CH9374B设计的KVM，CH9374B是一款4口USB KVM控制芯片，1套键鼠支持4套主机共享使用，即插即用，无需安装驱动程序。
* 当usb插入pc，且pc处于开机状态，则对应usb口的power灯将会亮起。
* 通过按下不同通道的按键，键鼠将切换到对应的pc通道，几乎零延时，同时对应通道的link灯将亮起。
* 各个pc的usb口采用了防倒灌的设计，让各位伙伴即使在华南主板面前也游刃有余。
* 同时在边上预留了一排排针，以后可以设计一个控制HDMI信号的切换的模块，跟kvm联动，自动控制对应的pc信号输出。

## 开源链接

* [立创开源](https://oshwhub.com/zhang0819/kvm-4xusb2-0)：https://oshwhub.com/zhang0819/kvm-4xusb2-0
