---
title: MCU中OTP的一些用途
date: 2024-07-11 11:24:53
categories:
tags:
    - c
    - 嵌入式
---

在微控制器（MCU）中，OTP（One-Time Programmable）内存用于存储无法更改或仅能编程一次的数据。OTP的一些常见用途包括：

1. **固件和引导加载程序的存储**：将固件或引导加载程序永久存储在OTP中，确保设备启动时的代码不可更改，增加安全性。

2. **设备唯一标识**：在OTP中存储唯一的序列号或设备ID，用于设备认证和追踪。

3. **配置数据存储**：存储设备的配置参数，如校准数据、网络设置等，这些数据在出厂时设置，之后不再更改。

4. **安全密钥存储**：存储加密密钥或安全认证密钥，用于加密通信或设备认证，提高安全性。

5. **版权保护/防拷贝**：通过在OTP中存储特定的认证数据或密钥，防止软件或固件被非法复制。

这些用途其实都是为了保护设备的安全性和完整性，防止未经授权的访问或篡改。OTP的特点是一次编程后数据不可更改，这种特性使得OTP适用于存储那些需要保持不变的数据。

<!-- more -->

## 存储固件和引导加载程序

在MCU中，固件和引导加载程序是设备正常运行的基础。将这些代码存储在OTP中可以确保设备启动时的代码不会被篡改，提高设备的安全性和稳定性。一旦固件和引导加载程序被编程到OTP中，就无法更改，这可以防止恶意软件或病毒对设备进行攻击。

从启动引导程序入手是很常见的破解手段，攻击者可以通过篡改引导程序来实现对设备的控制。将引导程序存储在OTP中可以有效防止这种攻击，确保设备启动时的代码是可信的。

## 存储设备唯一标识

设备唯一标识是设备的身份证明，用于设备认证、追踪和管理。将设备唯一标识存储在OTP中可以确保每个设备都有唯一的标识，防止设备被复制或冒充。这对于设备的安全性和管理都是非常重要的。

这个唯一标识的生成通常是通过芯片的一些特性，比如芯片的序列号、MAC地址等，这些数据在芯片生产时被写入OTP中，之后不再更改。这样就可以确保每个设备都有唯一的标识，方便设备的认证和追踪。

## 存储配置数据

配置数据是设备运行时需要的一些参数，比如网络设置、校准数据等。这些数据在设备出厂时被设置，之后不再更改。将配置数据存储在OTP中可以确保设备在运行时能够正确地获取这些参数，提高设备的稳定性和可靠性。

## 存储安全密钥

安全密钥是设备安全通信和认证的重要工具。将安全密钥存储在OTP中可以确保这些密钥不会被篡改，提高设备的安全性和可靠性。安全密钥通常会跟设备的唯一标识相关联，确保每个设备都有唯一的密钥，防止密钥泄露或复制。

## 防止固件被非法复制

通过在OTP中存储特定的认证数据或密钥，可以防止固件被非法复制。当设备启动时，固件会检查OTP中的认证数据或密钥，只有当这些数据或密钥与固件中的数据匹配时，固件才会运行。这样就可以防止未经授权的固件被复制或运行，提高设备的安全性和可靠性。

这是比较常用的方法，如果还不解恨，可以在异常后再加入一些混淆，让程序看上去正常运行了，但实际上很多莫名其妙的的错误😁

虽然我非常崇尚开源，但是在一些商业产品中，保护知识产权和版权是非常重要的。通过使用OTP来防止固件被非法复制，可以保护开发者的知识产权。事实上很难完全防止固件被破解，这就是软件世界的矛与盾，没有绝对的安全，增加防护措施只是增加破解的难度和门槛，避免自己辛辛苦苦开发的产品被轻易盗版。

理想情况下大家都互相尊重版权，尊重知识产权，就不用在这些上面费脑筋耗精力了，希望我们都能早日摆脱这个问题。

OTP的使用需要谨慎，因为一旦编程，数据就无法更改或擦除，这既是其优点也是限制。在设计时，需要仔细规划OTP的使用，以确保灵活性和安全性。