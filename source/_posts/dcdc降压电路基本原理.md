---
title: dcdc降压电路基本原理
date: 2023-04-25 14:57:13
mathjax: true
categories:
tags:
  - 硬件
  - 电源
---

## 1. DCDC转换器简介

> 在电子产品中，我们常需要不同的直流电压来为电路提供工作，这时我们便会见到LDO和DC/DC的身影，但是严格意义上LDO也是一种DC/DC，在电源芯片选型中，LDO和DC/DC则是两种完全不同的芯片。与线性稳压器LDO相比较，效率高是DC/DC的显著优势，通常效率在70%以上，效率高的可达到95%以上。

<!-- more -->

DCDC转换器常见的三种拓扑结构分别为Buck（降压型DC/DC转换器）、Boost（升压型DC/DC转换器）、Buck-Boost（升降压DC/DC转换器），简易拓扑结构图如下所示：

<img src="https://imgs.boringhex.top/blog/降压buck拓扑.jpg" alt="降压buck拓扑"/>  

<img src="https://imgs.boringhex.top/blog/升压Boost拓扑.jpg" alt="升压Boost拓扑"/>  

<img src="https://imgs.boringhex.top/blog/升降压拓扑.jpg" alt="升降压拓扑"/>

本篇文章主要以降压型DCDC转换器为例，简要介绍降压DCDC芯片选型时需要注意的主要参数，选型方法以及芯片外围匹配电路元件参数的计算。

## 2. 降压式（Buck）转换器基本原理

降压式（Buck）变换器是一种输出电压≤输入电压的非隔离直流变换器，Buck变换器的主电路由开关管S1，二极管D，输出滤波电感L和输出滤波电容C构成（详见上条Buck简易拓扑图），基本工作原理如下：

<img src="https://imgs.boringhex.top/blog/开关闭合电流.jpeg" alt="开关闭合电流"/>  

<img src="https://imgs.boringhex.top/blog/开关断开电流.jpeg" alt="开关断开电流"/>

当开关管S1闭合时，电感L被充磁储能，流经电感的电流线性增加，同时给电容C充电，给负载RL提供能量（如左图所示），此时Vout电压缓慢上升，若S1一直闭合则最终Vout会近似等于Vin电压（S1有耗损压降）；

当开关管S1关断时，储能电感L通过续流二极管D放电，电感电流IL线性减少，输出电压Vout靠输出电容C放电Ic以及减小的电感电流IL维持(如右图所示)缓慢下降，若S1一直保持关断，则Vout会最终降至0V；

按上述描述，Buck输出电压Vout曲线近似如下左图所示：

<img src="https://imgs.boringhex.top/blog/Buck输出电压曲线.jpg" alt="Buck输出电压曲线"/>  

<img src="https://imgs.boringhex.top/blog/Buck输出电压曲线2.jpg" alt="Buck输出电压曲线2"/>

由此可知，通过控制开关管S1开启关断的占空比，可以控制输出电压Vout的大小（如上图所示）。

一般DCDC集成芯片内部会集成电压调节电路，通过芯片输出端接分压电阻器将输出电压采样到FB(VFB)端，也就是反馈端，与基准电压对比后通过运放输出一个电压，与三角波对比，产生PWM信号，驱动功率管，实现电压的闭环控制。

降压型(Buck)转换器按整流方式不同，分为异步整流型Buck和同步整流型buck：

<img src="https://imgs.boringhex.top/blog/异步BUCK.jpg" alt="异步BUCK"/>  

<img src="https://imgs.boringhex.top/blog/同步buck.jpg" alt="同步buck"/>

**非同步整流Buck**

以上描述的通过二极管D来完成的续流回路，这种属于非同步整流型Buck转换器，也叫异步Buck转换器（见上图“异步整流Buck”）。

续流回路中采用的是二极管，具有单向导电性，不需要外加电路控制其通断，因此它只有一个mos管（或者说开关管）需要用电路控制，也就不用去强调同步控制二极管，即可以理解为非同步。

因为二极管需要一定导通压降才能导通，如果输出电流比较大，那么就会有比较大的额外消耗，另一方面，如果输出电压是比较低的时候，比如说是1.2V，那么二极管导通压降就占了很大的比例。所以在大电流，小电压输出时候效率偏低。

**同步整流Buck（Synchronous Step-Down Converter）**

另外还有一种就是同步整流型Buck。同步Buck在电路中续流回路中使用的也是MOS管（Q2），即上下管都是MOS管，因为MOS管本身是需要外部控制的元器件，整流过程中必须根据电源的开关时序同步控制Q1与Q2，所以该电路理解为同步（见右上图“同步整流Buck”）。

同步Buck的控制较为复杂，需要额外的驱动电路和控制电路保证电路正常工作，如果死区时间处理不当，有可能上下管直通，造成MOS管损坏(这是指的是电源控制器外接同步整流MOSFET的情况)。对于内部集成了控制器，上下管的电源管理芯片，由于MOSFET的特性已知，控制和MOSFET集成，可以很好的解决上面提到的控制问题，不需要过多担心。

同步和异步的区别从外部来看是同步的没有续流二极管。BUCK的输出电流是分成两个部分的，一个部分是来自电源，一个部分是来自异步电路中的这个二极管，同步电路把这个二极管用一个内置的MOSFET给替代了，但是这个MOSFET的开和关需要芯片内部额外的控制电路来保持和开关MOSFET的相位关系。

从性价比、可靠性和高电压输出场景表现，优先选择异步BUCK电路。从功耗、效率和非连续工作场景噪声表现，优先选择同步BUCK电路。

## 3. DCDC芯片选型主要参数参考

DC/DC选型时首先应考虑输入输出电压，输出负载，效率，成本，封装，开关频率是否满足应用，特殊的应用还需要考虑静态功耗（如手持设备），待机功耗等等。

**输入电压范围  (Input Voltage)**

考虑实际使用输入的电压波动范围，对照DC/DC器件手册推荐工作电压范围选用，确保不能超过器件规格。

**输出电压(Vout)**

输出电压是DC/DC很重要的参数，也是电子设备设计者选型时首先应考虑的参数。DC/DC有固定输出电压和可调输出电压两种类型。

**最大输出电流 (Max Current)**

持续的输出电流能力是DC/DC器件一个重要的参数，选用时要参考此参数，并要保留一定的余量，DC/DC的输出电流参数的选取需评估后级电路的瞬间峰值电流和发热的情况，综合来确定，并满足降额要求（一般满足80%降额，即若实际需要2A则至少应选择2.5A及以上电流输出能力的DCDC）。

**纹波噪声 (Ripple)**

DC/DC器件开关动作以及对电感电容充放电，都会造成EMI（电磁辐射/干扰）和电源纹波较大问题。若DC/DC器件的纹波较大，会直接影响器件的转换效率，影响系统工作不稳定，发热量偏高，使整个系统的功耗偏大。

关于纹波能达到的指标取决于电源本身的设计，同时需要考虑电源系统带负载的实际需求，即要关注轻载和重载纹波。电源每路输出负载的纹波值与该路的电流值有关系，电源在轻载下纹波一般是不会超标的。DCDC电源纹波一般应该在200mV至50mV以下，满载不能超过该范围。

在实际使用中，大部分要求高的数字芯片为**5%**的纹波要求，小信号的模拟电路，对电源纹波要求非常高，一般要求在50mV甚至更低，此时可能需要考虑采用线性电源。

高速、高精度数据采集系统对精度和速度都有较高要求，对电源的纹波噪声极其敏感，除要求电源的纹波噪声小外，还需选用一些高精度、共模和电源抑制比大的运放来配合，电源的纹波噪声一般都需控制在10mV以内。

**开关频率 Switching Frequency**

DCDC一般有几百K上M的工作频率，开关频率决定了外部电感的选型，频率越大需要的电感值就相对小一些，节省电路板面积。外部电感越大，对纹波的抑制作用越好，缺点是不能快速的响应负载的变化。

**效率 Efficiency**

DC/DC器件具有较高的转换效率，在大功率电源转化中不会造成过大热能损耗和散热问题。同时要关注轻载和重载两种情况，轻载会影响待机功率，重载会影响温升。一般要能够达到80%以上。

**负载调整率 (Load Regulation)**

电源负载的变化会引起电源输出电压的变化，负载增加，输出电压降低，相反负载减少，输出电压升高。好的电源负载变化引起的输出变化较小，通常指标为3%--5%。负载调整率是衡量电源好坏的指标，好的电源输出接负载时电压降较小。

> 负载调整率 =（无负载电流时的负载电压-满负载电流时的负载电压）/ 满负载电流时的负载电压 * 100%


## 4. 实例演示

以前段时间设计的一款降压型DCDC模块为例，简要介绍该模块的设计过程。该降压模块选用的DCDC芯片为西安航天民芯的M3406-ADJ。以下是在某商城搜到这款芯片的销售信息，芯片为国产，封装较为通用，作为DCDC价格仅售0.2元/pcs，销量也比较可观，因此为了验证该芯片性能，设计了一款降压模模块。

<img src="https://imgs.boringhex.top/blog/M3406价格.jpeg" alt="M3406价格"/>



### 4.1 M3406-ADJ芯片基本介绍

打开M3406-ADJ芯片datasheet了解到芯片的基本信息如下：

- 输入电压范围2V ~ 6V
- 输出电压可调最低0.6V
- 800mA输出电流
- 静态电流20uA
- 1.5MHz开关频率
- 芯片为同步Buck（Synchronous Step-Down Converter），因此不再需要外加续流二极管，外围元件相对较少
- 转换效率最高至96%

<img src="https://imgs.boringhex.top/blog/经典电路.jpg" alt="经典电路"/>

如上图所示芯片手册截图所示，芯片推荐电路外围元件较少；降压模块设计的输出电压为3.3V，参考左侧VIN = 5.0V的转换效率曲线，在满载800mA时，效率依旧可达到85%以上。

### 4.2 芯片外围电路设计

如下图所示为此M3406-ADJ芯片的降压模块原理图：

<img src="https://imgs.boringhex.top/blog/M3406-ADJ降压电路.jpg" alt="M3406-ADJ降压电路"/>

1. **分压电阻R1,R2的选取**，是依据手册中给出的FB反馈参考电压Vref计算得出的：$V_{out} = V_{REF} \times (1+\frac{R1}{R2})$

此设计中 $V_{out}$ = 3.3V，查手册知$V_{ref}$ = 0.6V，R1,R2要选择市面上常见的电阻值，精度至少要1%精度，此外这两个电阻可以尽可能取值大一些，以此可以降低模块的待机功耗。

2. **输入输出电容的选取**：

输入电容$C_{in}$：由于流过DC/DC芯片内部MOSFET开关管的电流Isw是不连续的，输入电容$C_{in}$的作用是用来提供一个低阻抗的电流源来提供MOSFET电流，输入电容可以减少从输入端引出的浪涌电流和来自设备的开关噪声。输入电容可以是电解、钽或陶瓷电容。

输出电容$C_{out}$：输出电容器($C_{out}$)常用来降低输出电压纹波，保持输出直流电压。输出电容器的特性会影响稳压系统的稳定性。要保持较小的输出电压的过冲和下降，电容应该有较小的ESR和ESL，较大的瞬态负载变化时需要较大容量的电容作为储能电容。开关频率较高，或者负载变化不大的场合用瓷片电容即可，对于电解电容主要考虑ESR部分的纹波，对于陶瓷电容主要考虑电容纹波。

在此设计中，按照芯片手册推荐，$C_{in}$选取4.7uF及以上容值的电容器，$C_{out}$推荐10uF电容器即可满足大部分设计应用的需求。因此在此降压模块设计中，选用两个10uF的X5R或X7R陶瓷电容（具有较低ESR，温度系数较小），分别作为$C_{in}$,$C_{out}$电容即可满足要求。此外电容需要注意耐压值的选取要≥1.5~2倍的电容两端电压。

3. **电感的选取** 

$$
\begin{equation}
L = \frac {V_{out} \times \left ( V_{in} - V_{out} \right )} {V_{in} \times \Delta I_{L} \times f_{osc}}
\end{equation}
$$

> $V_{out}$ ——  输出电压
>
> $V_{in}$    ——  输入电压
>
> $f_{osc}$  ——  芯片工作的开关频率，具体查看Datasheet
>
> $\Delta I_{L}$   ——  输出电感上的纹波电流，一般情况选取$\Delta I_{L} = \left ( 30\\% \sim 50\\% \right ) I_{out}$

**电感电流的选取依据：**

$$
\begin{equation}
I_{peak} = I_{out} + \frac {V_{out} \times \left ( V_{in} - V_{out} \right )} {2 \times f_{osc} \times L \times V_{in}}
\end{equation}
$$

> $I_{peak}$ ——  电感的峰值电流
> 
> $V_{in}$    ——  所需的负载电流

结合公式(1) (2)，可得电感峰值电流:

$$
\begin{equation}
I_{peak} = I_{out} + \frac {\Delta I_{L}} {2}
\end{equation}
$$

电感电流分为饱和电流$I_{sat}$和温升电流$I_{rms}$。

饱和电流$I_{sat}$定义为电感量下降20%对应的电流，温升电流$I_{rms}$是电感自发热使温度上升40°C的电流。电感选型时，峰值电流应小于饱和电流和温升电流的最小值。

电感的感量并不是必须完全按照理论计算出来的，只要有个大概就好，对输出的影响主要在纹波，只要满足系统电源要求就可以，对于公司来说，电感量尽量选取一致。此设计中，选取的电感值为2.2uH,较低的电感值可以选取到较小的封装尺寸。

该设计过程写的比较简单，整个选型设计流程大概如下：

1. 确定需求（输入电压，输出电压，负载电流）；
2. 选择芯片（价格，封装，供货情况）；
3. 根据芯片规格书确定电路设计（输入电容，输出电容，输出电感，输出电压配置等），需要考虑降额设计。
   

### 4.3 实验结果展示

以下3组图片为3个M3406-ADJ降压模块的测试结果，在轻载重载状态下，转换效率均能达到85%以上，基本符合手册的描述。

<img src="https://imgs.boringhex.top/blog/德立电感.jpg" alt="德立电感"/>   

<img src="https://imgs.boringhex.top/blog/顺络电感.jpg" alt="顺络电感"/>   

<img src="https://imgs.boringhex.top/blog/长江微电电感.jpg" alt="长江微电电感"/>

## 5. pcb布局设计注意事项

实际应用中PCBlayout中要注意的事项：

1. 输入电容尽量靠近Vin引脚，减少寄生电感的存在，因为输入电流不连续，寄生电感引起的噪声对芯片的耐压以及逻辑单元造成不良影响 。输出滤波电容尽量靠近Vout引脚；

2. 功率回路尽可能的短粗，保持较小的环路面积，较少噪声辐射。SW是噪声源，保证电流的同时保持尽量小的面积，远离敏感的易受干扰的位置。如，电感靠近SW引脚，远离反馈线。输出电容靠近电感，地端增加地过孔；

3. 加粗地线宽度或者接地铜皮面积，如果不同层，要多打地孔；

4. 反馈电阻尽量靠近FB引脚，从RFB到FB引脚的连线尽量短，因为这段线极易受到干扰，对输出特性影响较大；大电流负载的FB在负载远端取，反馈电容走线要就近取。

5. 电感尽量选取屏蔽类型的，电感正下方所在区域不要有地线，电感量辐射容易影响地平面电平，电感下方的Bottom Layer布线影响不大。

6. 芯片散热要按设计要求，尽量在底下增加过孔散热。

