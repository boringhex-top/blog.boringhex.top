---
title: 运放和比较器-2
date: 2023-05-17 12:15:21
categories:
tags:
    - 硬件
---

今天继续了解输入阻抗问题，观察下图:

![阻抗](https://imgs.boringhex.top/blog/202305050955403.png)

了解之前先做以下约定：

1. 红框代表信号源，内阻由电阻分压代替。
2. 黑框代表运放器，电阻代表共模阻抗即运放输入脚对地的电阻。
3. IN+/IN- 代表运放的两个输入脚中的一个。
4. A 点代表信号源的输出信号，运放的输入引脚。

<!-- more -->

首先考虑在我们没有接运放时，A点输出电压为6V,当接入如图所示的阻抗时电压还是6V吗？共模电阻和红框内对地电阻并联，阻值变小，相当于5k，通过计算可以求得A点电压变为4V，这样A的值发生了改变，试想一下这样的信号接入到运放的两端是不是相当于比较的两端信号发生了改变，那结果一定会发生偏离。信号源一般内阻是不确定的，一般也不是很小，如果不想改变输入阻抗，那唯一的办法就是改变运放的内阻了，比如内阻改为100K，1M等，越大越好，是不是A点电压就会无限接近6V。那怎样能使用小电流驱动大负载呢？这样的器件是不是我们首先能想到三极管，当三极管发射极接上电阻后是不是就可以看作为一个恒流源，三极管可以完成用uA控制mA设备，如果感觉输入电流还是大呢？对！再加一级。那么我们设定放大倍数为100，两级放大基极电流即为输出电流的1/10000，请看下图：

![恒流源](https://imgs.boringhex.top/blog/202305050956438.png)

此时三极管工作恒流的模式，我们可以假设需要1mA的电流，那么Q2的基极电流是不是就是1/100即10uA，Q1的基极电流为10uA/100,这时候就相当于A点的对地阻抗很大，运放输入就是使用的这个原理。

问题：我们可以再增加一级继续将电流减少吗，这样阻抗是不是更大？

> 答案是不可以的，此时A点电流就已经很小了，如果再小那抗干扰就特别差了。
> 
> 此时的阻抗可以说相当大了，也没有必要再去加一级了。

这个电路还有一个问题，就是A处的电压不能太低至少要1.4V（驱动电压为0.7V计算），所以对于检测信号会有幅值要求限制，怎么可以减少这个门槛电压呢?我们会不会想到P管，更换一下，继续分析下图，看看能否符合。

![P管恒流源](https://imgs.boringhex.top/blog/202305050958892.png)

根据P管的特性现在幅值门槛的问题解决了，A点不再受电压影响，原来高阻抗的特性也没有改变，只是电流方向和N管有一定的区别，但是并不影响我们理解。

到这里先总结下运放有哪些特点：

1. 输入阻抗大
2. 幅值需要放大
3. 功率需要放大

目前我们已经做到输入阻抗大了。

接着梳理，A点电压变化，影响到C点电压，追其原因其实就是一个电压跟随。

我们改变A点的电压就控制了CD间的电流，需要注意的是要精确控制电流。如果做不到精确，放大后误差就更大了。

## 镜像电流源

第一级的电路不仅要实现阻抗无穷大， 而且还要实现把两个输入信号的电压差转化为电流差， 这个电流差是为第二级准备的。 那么， 这里就需要用到一个新的概念： 镜像电流源，也常被叫作电流镜。  

字面意义就是有两个电流，就像照镜子一样。这样我们就可以通过控制一端电流得到另一端电流了。在此之前我们还需要了解一下三极管的饱和与放大。

![三极管输出](https://imgs.boringhex.top/blog/202305050958079.png)

这个电路大家应该很熟悉，Q3在饱和导通时Uo电压等于0.3V左右，当Ui较小时三极管会处于放大状态，此时Uo输出又是多少呢？是不是Q3和R22分压后的到结果。此时Q3可以看做一个可变电阻，当内阻大时，输出电压也会变大，当内阻小时Uo也会变小。当Uo接近0.3V时，此时的状态是临界饱和状态。

![临界饱和状态三极管](https://imgs.boringhex.top/blog/202305050959090.png)

如上图这样连接时B点的电压等于C点电压约为0.7V，已经接近0.3V了，此时电路就工作在临界饱和状态。再试想下把两个相同三极管的基极接一起，放到一个晶圆上会发生什么呢?

![镜像电流源](https://imgs.boringhex.top/blog/202305050959721.png)

这时Uo和F点的电流有什么关系呢？是不是电流相等，因为两个三极管的基极是连到一起的，两个三极管也是一样的，同时放在一个晶圆上，温度也是一样的。当A点断开，Q4处Ic的电流受控于Q3处的Ic电流，当调节R22时，Q4的Ic电流就会等于Q3的Ic电流，这时我们可以认为左边的电流是右边电流镜像过来的，两边电流相等、对称，就叫镜像电流。

> 注意：
>
> 在分立器件中三极管和二极管一样通常是不能直接并联的，受到功率影响还会烧毁器件。因为分立器件不能做到完全一样，等效电阻不一样，导致一个电流大一个电流小，而半导体是负温度特性，并联后由于内阻不一样电流大的温度会升高，温度升高电流又会增大，这样不断恶化最后导致器件烧毁。这里说的三极管之所以可以并联是因为在晶圆上可以做到高度一致，温度也是一样的。

## 运放或比较器的第一级电路

我们将高阻抗输入的那个图和镜像电流源结合：

![运放第一级电路示意](https://imgs.boringhex.top/blog/202305052215879.jpg)

通过分析上图我们可以得到以下结论：

1. 有两个输入引脚，并且是高阻抗输入，输入电压没有阈值限制。

2. Ic1的电流受控于Ic2的电流。

3. Ic1的电流由Q2和Q5的内阻分流而来。

4. 通过观察输入控制端IN-确定后，Ic2的电流就确定了，此时流经Q5电流也就决定了，但具体多少还要取决Q2的Ic大小，如果IN+大，Ic电流就小，也就是Q5的Ic电流需要外部供给。当IN+小时，又可以从Ic1流出多余的电流。

5. 反馈电阻（R15）在芯片中是阻值很大的一般用恒流源代替的，芯片在制造中是没有办法做大电阻的，而做恒流源是很方便的。

需要注意的是与实际使运放比较是不是感觉逻辑是反的？是的我们其实应该交换两个输入的名称，这样就可以和我理解的运放就对上了。

继续实现上面总结4中的电路：

![运放第一级电路](https://imgs.boringhex.top/blog/202305051001310.png)

再来分析下这张图，当输入IN+ > IN-时，Ic2 > Ic1,又因为Ic5 = Ic6，所以Ic2这条路上就会多出电流，多出来怎么处理呢？是的，可以增加一条回路，让它流到其他地方，Q7也可以看作是一个可变电阻，此时OUT就会有不同的电压值。当IN+ < IN-时，思路是一样的，这里不再赘述。

从这里开始运放和比较器就有差别了，比较器需要迅速到达饱和区，我可以在OUT处继续添加一级三极管，同样工艺也要把饱和区做小，这样斜率就会做的非常陡，这也就是为什么比较器边沿变化快的原因。对于运放而言我们是希望放大区更大，需要工艺上做专门的处理。

这章就先说到这里，后面继续处理这里的OUT。
