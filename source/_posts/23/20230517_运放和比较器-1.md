---
title: 运放和比较器-1
date: 2023-05-17 12:11:02
mathjax: true
categories:
tags:
    - 硬件
---

## 比较器的引脚组成

比较器我们应该比较熟悉，通过名字也能知道是用来做比较用的。所以比较器有两个输入脚，除这两个脚外还包括一对电源引脚，一个输出引脚。那内部结构我们是不是还不太了解？没关系，接下来我们一起来了解下。

![比较器](https://imgs.boringhex.top/blog/202304251838679.jpg)

<!-- more -->

比较器的输入脚可以是两个模拟量，输出是一个数字量。模拟量就是连续不间断的，而数字量就两种状态高或低，相当于开关的两种状态。那输出高具体是多少伏呢？这就和比较的输出类型有关系了。比较器输出一般是OC输出（集电极输出），使用时要接上拉电阻，所以可以上拉到和电源电压不同的电压，使用较为灵活。当然还有一种是推挽输出，此时的输出最高电压是不能超过电源电压的。

## 比较器和运放的输出对比

比较器输出不是高就是低，那就是饱和输出，而运放很多时候没有饱和的输出，运放更多的是工作在放大状态，运放输出是一个连续变化信号，属于模拟量。比较器输出不是截止就是饱和，但是它真的是阶跃（突然发生改变）的吗？放大示波器的时间轴会发现其实在变化中间是有一个斜坡的，只是我们使用会直接忽略掉而已。

比较器两个输入端一个是正输入一个是负输入，当正输入大于负输入时输出为高，反之为低。其实比较器就是比较的两个幅值，数字信号就是模拟信号的两个特殊值，所以数字信号是一种特殊的模拟信号。模拟信号通过比较器后就可以转为数字信号，所以比较器属于一种模数转换器件，比如我们最近应用就是将900M载波ASK信号解调出来，应用的就是比较器，具体实现及应用将在后面案例中。再比如我们还可以用来检测是否过流，一端接基准电压如1V，另一端接采样信号，当采样电压高于1V时，输出为高，可以根据需要采取对应的措施，可以很容易实现过流保护。

运放大多数工作在放大状态，目的是为了放大信号，那么运放是不是可以实现将一个很小的信号放大到一个很大的信号呢？当然输出肯定也不能超过电源电压，比如0.1V放大到1V，2V，3V,有种特殊情况就是饱和状态到达5V（5V供电的情况下），这种状态会等效为比较器，所以运放是可以当比较器来使用的。但是速度远远跟不上比较器，比如当你设计中需要一个比较器，而此时恰好还有一个运放而且应用的速度不高，这时就可以用运放来代替比较器，但在高速下区别就明显多了，那比较器是否可以代替运放呢？答案是通常是不行的，因为运放的放大区都比较小，不好控制，但是也要具体应用具体分析。

###  我们如何判断运放的速度呢？

低速高速就是边沿陡峭不陡峭的问题。一个比较器选定了那么它的沿就确定了，沿陡就是高速的。我们通过下图来比较说明：

![频率对比](https://imgs.boringhex.top/blog/202304251127180.jpg)

如上图中，比如L358放大器，在1时频率比较低，随着频率的加大，周期会变短，到3时就成了三角波，幅值也变成了最高，但随着频率的再次增加输出的幅值就会下降，当幅值将为原来的70.7%时，该器件就不能用了。实际的频率我们可以通过手册中的特性表获得，这片芯片高于20k就已经不能用了。

### 运放的输出

我们在实际应用放大器时是不是要使其工作在放大状态，我们可以联想下三极管，如果让三极管工作在放大状态是怎么完成的呢，是不是在射极增加反馈电阻，不管是放大多少倍，最后通过调节都能调节到我们需要的电流。如果能明白三极管的放大原理，我们可以同理来理解运放。运放和三极管不同之处是一个放大电压，一个放大电流。理想的运放可以放大无穷倍，一般我们就说是10万倍（方便认知），实际可以通过手册获取该值。

## 基本概念

两种器件的内部电路第一级实际是一样的，几乎没什么区别，为了研究运放和比较器的输入信号，我们还是要先理解几个概念，这样的话我们在看手册或理解时都会有帮助。比较器或运放都是两个输入信号，每个信号可以形成一个回路。我们把这条路由输入、阻抗、对地形成回路，叫作**共模信号**。共模信号指的是一个单独的信号。但比较器或运放是两个输入的差值，为了方便我们把两个共模输入的差信号称为**差模信号**。共模信号是对地的，对地阻抗就叫做共模阻抗。

对于输入的共模信号，我们希望给运放或比较器的输入端电压是不能变的，但每个源从内阻分析都会有一个带载的能力，那运放或比较器的输入对地都是有阻抗的，那输入信号接到比较器后肯定会有分压。信号源的内阻和运放的内阻分压后输给运放的电压就会降低。一旦降低那输出结果也会改变。那这问题怎么解决呢？是不是只要输入信号的内阻低，或运放比较器的内阻大就可以解决。信号源内阻一般都不会很小，我们放大就会受影响。这就只能通过解决共模内阻了。使共模内阻和信号源内阻不在一个数量级上。

![运放](https://imgs.boringhex.top/blog/202304251447910.jpg)

上图我们是经常见到的，但要理解上图还要知道两个概念虚短和虚断，这个是计算的前提条件，不管是查资料还是课本上都会讲到，估计大家也都知道怎么用，但是很少讲到为什么会虚短虚断的，我们后面会深入理解下它们的来源。

因为运放的3脚内部对地阻抗很大，就相当于没有电流流入，就像断路一样，实际是有微小电流的，所以叫虚断。4脚对地的阻抗也是很大，如果两个脚的电压相近，相差0.0000001V，那是不是可以说两点电压是相等的，就像短路一样，所以叫虚短。虚短虚断是从电压和电流来理解的。

下面我们来计算上图的输出Uo：

由于3脚的共模阻抗相当大，所以U1经过R2后电压不变，再由虚短可以知道4脚电压等于3脚电压。由于4脚的共模阻抗很大，所以只有很少部分电流流过，可以忽略。此时由UO-Rf-R1组成的回路就可以列出等式，Rf和R1间的电压为U1，此时有：

$$
\frac{U_{O}-U1}{R_{f}} = \frac{U1}{R1}
$$

整理得：

$$
U_{O}=U1 \times (1+ \frac {R_{f}}{R1})
$$

这样就根据虚断和虚断计算出来输入输出关系。

接下来我们会从输入阻抗来继续讨论放大器和运放，今天就以曾经做的小案例结束。

## 比较器小案例

![比较器实例](https://imgs.boringhex.top/blog/202304251630887.jpg)

上面整体完成的功能是900M载波ASK信号输入，解调输出信号包络的过程，这也是实际工程中用到的。

先大概说明，1部分为输入载波信号，电阻为匹配器件，由2部分二极管进行整流。通过比较器比较输出数字信号。接下来大概分析下3的部分，首先看下核心器件比较器，这个比较器选型点在于它属于开漏输出（当时设计时想设计成滞回方式），而且速度相对较高。输入的两端都来自于整流后的信号，3脚输入为经过一级滤波后的信号，4脚为一个比较平稳的电压，趋于直线。两个输入进行比较，输出就是一个单片机可以解析的数字信号。

其中3的阻容值是根据实际调试得来的，所以具体使用时还是要根据具体情况去匹配。
